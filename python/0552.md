题目编号：552

题目：学生出勤记录 II

难度：困难

考察范围：动态规划

题干：给定一个正整数 n，表示学生的出勤记录表的大小。记录表中第 i 条记录代表第 i 天学生的出勤情况，共有三个字符（"A"、"L" 和 "P"）：

"A" : Absent，缺勤
"L" : Late，迟到
"P" : Present，到场

如果学生能够同时满足下面两个条件，则可以获得出勤奖励：

按总出勤计，学生缺勤（"A"）严格少于两天。
学生不会存在连续 3 天或 3 天以上的迟到（"L"）记录。
给定一个整数 n，返回记录长度为 n 时，可能获得出勤奖励的记录情况数量。答案可能非常大，所以返回对 10^9 + 7 取余的结果。

解题思路：本题可以使用动态规划来解决。我们可以定义三个状态：

dp[i][j][k] 表示前 i 天，缺勤 j 天，结尾连续迟到 k 天的方案数。

其中，j 的取值范围为 0 到 1，因为缺勤天数不能超过 1 天；k 的取值范围为 0 到 2，因为连续迟到天数不能超过 2 天。

对于第 i 天，我们可以进行以下三种操作：

1. 出席（P）：此时缺勤天数和连续迟到天数都不变，方案数为 dp[i-1][j][0] + dp[i-1][j][1] + dp[i-1][j][2]。

2. 缺勤（A）：此时缺勤天数加 1，连续迟到天数归零，方案数为 dp[i-1][j+1][0] + dp[i-1][j+1][1] + dp[i-1][j+1][2]。

3. 迟到（L）：此时缺勤天数不变，连续迟到天数加 1，方案数为 dp[i-1][j][k+1]。

最终的答案为所有 dp[n][j][k] 的和，其中 j 的取值范围为 0 到 1，k 的取值范围为 0 到 2。

解决方案：

```python
class Solution:
    def checkRecord(self, n: int) -> int:
        MOD = 10**9 + 7
        dp = [[[0] * 3 for _ in range(2)] for _ in range(n+1)]
        dp[0][0][0] = 1
        for i in range(1, n+1):
            # 出席
            for j in range(2):
                for k in range(3):
                    dp[i][j][0] = (dp[i][j][0] + dp[i-1][j][k]) % MOD
            # 缺勤
            for k in range(3):
                dp[i][1][0] = (dp[i][1][0] + dp[i-1][0][k]) % MOD
            # 迟到
            for j in range(2):
                for k in range(1, 3):
                    dp[i][j][k] = (dp[i][j][k] + dp[i-1][j][k-1]) % MOD
        ans = 0
        for j in range(2):
            for k in range(3):
                ans = (ans + dp[n][j][k]) % MOD
        return ans
```

算法复杂度：时间复杂度为 O(n)，空间复杂度为 O(n)。