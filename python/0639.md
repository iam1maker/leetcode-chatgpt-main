题目编号：639

题目：解码方法 II

难度：困难

考察范围：动态规划

题干：

一条包含字母 A-Z 的消息通过以下方式进行了编码：

'A' -> 1
'B' -> 2
...
'Z' -> 26
除了上述的条件以外，现在加密字符串可以包含字符 '*'，可以表示从 1 到 9 的任意数字（不包括 0）。例如，字符串 "1*" 可以表示 "11"、"12"、"13"、"14"、"15"、"16"、"17"、"18"、"19"。

给定一串数字解码方法的总数。

例如：

输入: "*"
输出: 9
解释: 加密的信息可以表示为： "1", "2", "3", "4", "5", "6", "7", "8", "9"。

输入: "1*"
输出: 18
解释: 加密的信息可以表示为： "11", "12", "13", "14", "15", "16", "17", "18", "19", "21", "22", "23", "24", "25", "26"。

注意：

输入的字符串长度范围是 [1, 105]。
输入的字符串只会包含字符 '*' 和 数字 '0' - '9'。

解题思路：

本题是一道动态规划的题目，我们可以定义 dp[i] 表示前 i 个字符的解码方法总数。

对于第 i 个字符，我们需要考虑以下情况：

1. 如果 s[i] 是数字，那么它可以单独解码，也可以和前一个数字组成一个两位数解码。如果 s[i-1] 是数字，那么它们可以组成一个两位数解码，此时 dp[i] = dp[i-1] + dp[i-2]；否则，s[i] 只能单独解码，此时 dp[i] = dp[i-1]。

2. 如果 s[i] 是星号，那么它可以代表 1-9 中的任意一个数字，所以它可以单独解码，也可以和前一个数字组成一个两位数解码。如果 s[i-1] 是数字，那么它们可以组成一个两位数解码，此时 dp[i] = 9 * dp[i-2]；否则，s[i] 只能单独解码，此时 dp[i] = 9 * dp[i-1]。

3. 如果 s[i] 是 0，那么它只能和前一个数字组成一个两位数解码，此时 dp[i] = dp[i-2]。

4. 如果 s[i] 是其他字符，那么无法解码，直接返回 0。

最终的答案就是 dp[n]，其中 n 是字符串的长度。

解决方案：

```python
class Solution:
    def numDecodings(self, s: str) -> int:
        if not s:
            return 0
        n = len(s)
        dp = [0] * (n+1)
        dp[0] = 1
        if s[0] == '*':
            dp[1] = 9
        elif s[0] != '0':
            dp[1] = 1
        for i in range(2, n+1):
            if s[i-1] == '*':
                dp[i] += 9 * dp[i-1]
                if s[i-2] == '1':
                    dp[i] += 9 * dp[i-2]
                elif s[i-2] == '2':
                    dp[i] += 6 * dp[i-2]
                elif s[i-2] == '*':
                    dp[i] += 15 * dp[i-2]
            else:
                if s[i-1] != '0':
                    dp[i] += dp[i-1]
                if s[i-2] == '1' or (s[i-2] == '2' and s[i-1] <= '6'):
                    dp[i] += dp[i-2]
                elif s[i-2] == '*':
                    if s[i-1] <= '6':
                        dp[i] += 2 * dp[i-2]
                    else:
                        dp[i] += dp[i-2]
            dp[i] %= 10**9 + 7
        return dp[n]
```

算法复杂度：时间复杂度为 O(n)，空间复杂度为 O(n)。