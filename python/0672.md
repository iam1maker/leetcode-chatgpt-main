题目编号：672

题目：灯泡开关 Ⅱ

难度：中等

考察范围：数学、逻辑思维

题干：现有一个房间，墙上挂有 n 只已经打开的灯泡和 4 个按钮。在进行了 m 次未知操作后，你需要返回这 n 只灯泡可能有多少种不同的状态。假设这 n 只灯泡初始状态都是关闭的。

操作 1：将所有灯泡的状态反转（即开变为关，关变为开）
操作 2：将偶数编号的灯泡的状态反转
操作 3：将奇数编号的灯泡的状态反转
操作 4：将 3k+1 编号的灯泡的状态反转（k = 0, 1, 2, ...)

解题思路：数学推导

首先，我们可以发现，操作 1 和操作 2、3 是等价的，因为操作 2、3 可以通过操作 1 实现。所以我们只需要考虑操作 1 和操作 4。

我们可以将操作 4 看作是对于每个灯泡，每隔 3 个进行一次反转。例如，对于编号为 1 的灯泡，它会在第 1、4、7、10、... 次操作时被反转。

接下来，我们考虑每个灯泡最终的状态。对于编号为 i 的灯泡，它会被操作 1 反转 m 次，被操作 4 反转 k 次。所以它最终的状态为：

初始状态为关闭：m + k 为偶数，灯泡关闭；m + k 为奇数，灯泡打开。
初始状态为打开：m + k 为偶数，灯泡打开；m + k 为奇数，灯泡关闭。

因此，我们只需要统计所有灯泡最终状态为打开的情况数即可。

解决方案：

```python
class Solution:
    def flipLights(self, n: int, m: int) -> int:
        if n == 0 or m == 0:
            return 1
        if n == 1:
            return 2
        if n == 2:
            return 3 if m == 1 else 4
        if m == 1:
            return 4
        if m == 2:
            return 7
        return 8
```

算法复杂度：时间复杂度 O(1)，空间复杂度 O(1)。